<!DOCTYPE html>
<html lang="fr">
<head>
    <link rel="icon" type="image/png" href="https://i.imgur.com/FEke8Cf.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeRun Market - Votre MarchÃ© Ã  Antananarivo</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ffcc00">
</head>
<body>
    <div class="loading-bar"></div>
    <div id="user-sidebar" class="sidebar">
    <button class="close-sidebar" onclick="toggleSidebar()">Ã—</button>
   <div class="user-profile">
    <div class="user-avatar" id="user-initials">S</div> 
    <div id="qrcode-container" style="background: white; padding: 10px; border-radius: 10px; margin: 15px auto; width: 120px; height: 120px; display: none; border: 2px solid var(--primary);">
    <div id="qrcode"></div> </div>
    <h3 id="side-user-nom">Utilisateur</h3>
    <p id="side-user-tel" style="font-size: 0.9rem; color: #ffcc00; margin-bottom: 5px;">
        <i class="fas fa-phone"></i> NumÃ©ro non renseignÃ©
    </p>
    <p id="side-user-quartier"><i class="fas fa-map-marker-alt"></i> Quartier, Antananarivo</p>
    
    <button onclick="ouvrirInscription()" style="background: none; border: 1px solid #555; color: #ccc; font-size: 0.7rem; padding: 5px 10px; border-radius: 5px; cursor: pointer; margin-top: 10px;">
        Modifier mon profil
    </button>
</div>
    
    <nav class="sidebar-nav">
        <a href="#" class="nav-item active"><i class="fas fa-bolt"></i> <div><span>Livraison Express</span><small>Moins de 24h</small></div></a>
        <a href="javascript:void(0)" class="nav-item" onclick="ouvrirPlanification('Achat PlanifiÃ©')">
        <i class="fas fa-clock"></i> <span>Achat PlanifiÃ©</span> </a>       
        <a href="javascript:void(0)" class="nav-item" onclick="ouvrirLivraisons()">
        <i class="fas fa-truck-loading"></i> 
        <span>Livraison en cours</span>
        <span id="badge-livraison" class="badge-notif" style="display: none;">0</span>
        </a>
        <a href="#" class="nav-item"><i class="fas fa-check-circle"></i> <span>Achats validÃ©s</span><span class="notif-badge">0</span></a>
        <a href="javascript:void(0)" class="nav-item" onclick="contacterAssistance()">
    <i class="fab fa-whatsapp"></i> 
    <div>
        <span>Assistance WhatsApp</span>
        <small>RÃ©ponse rapide</small>
    </div>
</a>  
    </nav>
    </div>
    <div class="top-announcement">
        <div class="scrolling-text">
            âš¡ Livraison rapide sur tout Antananarivo â€” ğŸ›ï¸ QualitÃ© PPN garantie â€” ğŸ“ Service client : +261 38 24 536 10 â€” ğŸ“¦ Paiement sÃ©curisÃ© Ã  la livraison 
        </div>
    </div>

    <header>
        <div class="header-container">
            <div class="logo-area" style="position: relative;">
    <img src="https://i.imgur.com/FEke8Cf.png" alt="Logo SafeRunMarket" class="logo-img" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));"> 
    <div class="logo-text" style="letter-spacing: -0.5px;">
        SAFERUN <span style="color: var(--primary); text-shadow: 1px 1px 0px rgba(0,0,0,0.05);">MARKET</span>
    </div>
    </div>

            <div class="nav-elements">
                <div class="search-wrapper">
                    <i class="fas fa-search search-icon-inside"></i>
                    <input type="text" id="search" placeholder="Rechercher un produit...">
                </div>
                
                <div class="header-icons">
                    <div class="icon-item" onclick="toggleSidebar()" style="cursor:pointer;">
                        <i class="fas fa-user"></i>
                        <span class="icon-label">Compte</span>
                    </div>
                    <div class="icon-item cart-trigger" onclick="envoyerCommande()" style="cursor:pointer;">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-badge" id="cart-count" style="display:none;">0</span>
                        <span class="icon-label">Panier</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

   <section class="promo-slider hero-giz" id="hero-slider">
    <div class="hero-overlay"></div>
    
    <div class="hero-content">
        <span class="hero-badge" id="hero-badge">ğŸ”¥ Offre du moment</span>
        <h1 id="hero-title">LE MARCHÃ‰ SANS SE DÃ‰PLACER</h1>
        <p id="hero-desc">Vos PPN livrÃ©s chez vous Ã  Antananarivo en moins de 2h.</p>
        <button class="btn-promo" onclick="document.getElementById('search').focus()">
            <i class="fas fa-shopping-basket"></i> VOIR LES PRODUITS
        </button>
    </div>
</section>

    <div class="trust-bar-mini" style="text-align: center; margin-top: -30px; position: relative; z-index: 10;">
    <span style="background: #fff; padding: 8px 20px; border-radius: 50px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); font-size: 0.8rem; font-weight: 700; border: 1px solid #eee;">
        â­ 4.9/5 <span style="color: #666; font-weight: 400; margin: 0 5px;">|</span> <span style="color: #27ae60;">98% de clients satisfaits Ã  Tana</span>
    </span>
</div>

    <section class="trust-badges">
        <div class="badge-item">
            <i class="fas fa-truck-fast"></i>
            <span>Livraison Express</span>
        </div>
        <div class="badge-item">
            <i class="fas fa-shield-halved"></i>
            <span>QualitÃ© ContrÃ´lÃ©e</span>
        </div>
        <div class="badge-item">
            <i class="fas fa-hand-holding-dollar"></i>
            <span>Payez Ã  la livraison</span>
        </div>
    </section>
    <div class="category-filter-container">
    <button class="cat-btn active" onclick="filtrerParCategorie('Tous')">ğŸ›’ Tous</button>
    <button class="cat-btn" onclick="filtrerParCategorie('PPN')">ğŸš P.P.N <small style="background: #ff3b30; color: white; padding: 1px 5px; border-radius: 4px; font-size: 0.6rem; margin-left: 5px;">TOP</small></button>
    <button class="cat-btn" onclick="filtrerParCategorie('Alimentaire')">ğŸ Alimentaire</button>
    <button class="cat-btn" onclick="filtrerParCategorie('Conserves')">ğŸ¥« Conserves</button>
    <button class="cat-btn" onclick="filtrerParCategorie('Frais')">ğŸ¥¦ Frais</button>
    <button class="cat-btn" onclick="filtrerParCategorie('Hygiene')">ğŸ§¼ HygiÃ¨ne</button>
    <button class="cat-btn" onclick="filtrerParCategorie('Energie')">ğŸ”‹ Ã‰nergie</button>
    </div>
    <div id="boutique-section">
        <div id="status-planif" style="display:none; background: #e8f4fd; color: #2980b9; padding: 15px; text-align: center; font-weight: bold; border-radius: 10px; margin: 10px auto; max-width: 90%;">
    <i class="fas fa-calendar-check"></i> Livraison prÃ©vue le : <span id="date-affichage"></span>
    <button onclick="annulerPlanif()" style="background:none; border:none; color:red; cursor:pointer; margin-left:10px; text-decoration:underline;">[Annuler]</button>
</div>
        <div class="section-title">
            <h2>ğŸ›’ Nos Produits</h2>
            <div class="underline"></div>
        </div>
        <main id="boutique" class="container">
            <div id="loading-placeholder" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 15px;">
    <div class="skeleton skeleton-card"></div>
    <div class="skeleton skeleton-card"></div>
    <div class="skeleton skeleton-card"></div>
    <div class="skeleton skeleton-card"></div>
</div>
        </main>
    </div>

    <footer class="footer-premium">
        <div class="footer-waves"></div>
        <div class="footer-container">
            <div class="footer-brand">
                <img src="https://i.imgur.com/FEke8Cf.png" alt="Logo SafeRun" class="footer-logo">
                <h3>SAFERUN <span>MARKET</span></h3>
                <p>La qualitÃ© et les prix bas livrÃ©s chez vous Ã  Antananarivo.</p>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-whatsapp"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>

            <div class="footer-links">
                <h4>Nos Services</h4>
                <ul>
                    <li><a href="#">Livraison Express</a></li>
                    <li><a href="#">Produits Frais</a></li>
                    <li><a href="#">Paiement Cash</a></li>
                </ul>
            </div>

            <div class="footer-contact">
                <h4>Contact Direct</h4>
                <p><i class="fas fa-phone-alt"></i> +261 38 24 536 10</p>
                <p><i class="fas fa-envelope"></i> contact@saferunmarket.mg</p>
                <p><i class="fas fa-map-marker-alt"></i> Analamanga, Antananarivo</p>
            </div>
        </div>
        <div class="footer-copyright">
            <p>Â© 2026 SafeRun Market. DÃ©veloppÃ© avec â¤ï¸ pour Madagascar.</p>
        </div>
    </footer>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        function nextSlide() {
            slides[currentSlide].classList.remove('active');
            currentSlide = (currentSlide + 1) % slides.length;
            slides[currentSlide].classList.add('active');
        }
        setInterval(nextSlide, 5000); // Change toutes les 5 secondes
    </script>
    
    <div id="welcome-popup" class="welcome-popup">
    <div class="popup-content">
        <button class="close-popup" onclick="fermerPopup()">Ã—</button>
        <div class="popup-icon">ğŸ‘‹</div>
        <h4>Besoin d'aide ?</h4>
        <p>Devenez notre client privilÃ©giÃ© pour commander plus rapidement !</p>
        <button class="btn-inscription" onclick="ouvrirInscription()">S'INSCRIRE MAINTENANT</button>
    </div>
    </div>

    <div id="modal-panier" class="modal-system">
    <div class="modal-box">
        <button class="close-popup" onclick="fermerModal()">Ã—</button>
        <div id="detail-panier" style="text-align: left; margin-top: 20px;"></div>
        <hr>
        <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 1.2rem; margin: 15px 0;">
            <span>TOTAL :</span>
            <span id="total-modal">0 Ar</span>
        </div>
        <button class="btn-inscription" onclick="envoyerDonneesAuSheet()">ğŸš€ VALIDER MA COMMANDE</button>
    </div>
</div>

    <div id="modal-rdv" class="welcome-popup" style="display:none; z-index:1100; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); justify-content:center; align-items:center;">
  <div class="popup-content" style="max-width:350px;">
    <button class="close-popup" onclick="fermerRdv()">Ã—</button>
    <h3>ğŸ“… Prendre rendez-vous</h3>
    <p>Indiquez vos coordonnÃ©es et le crÃ©neau souhaitÃ© :</p>
    <input type="text" id="rdv-nom" placeholder="Nom complet" style="width:100%; padding:10px; margin:10px 0; border:1px solid #ddd; border-radius:8px;">
    <input type="tel" id="rdv-tel" placeholder="TÃ©lÃ©phone" style="width:100%; padding:10px; margin:10px 0; border:1px solid #ddd; border-radius:8px;">
    <input type="datetime-local" id="rdv-date" style="width:100%; padding:10px; margin:10px 0; border:1px solid #ddd; border-radius:8px;">
    <textarea id="rdv-commentaire" placeholder="Commentaire (facultatif)" style="width:100%; padding:10px; margin:10px 0; border:1px solid #ddd; border-radius:8px;"></textarea>
    <button class="btn-inscription" onclick="envoyerRdv()" style="width:100%;">CONFIRMER LE RENDEZ-VOUS</button>
  </div>
</div>

    <div id="modal-planification" class="welcome-popup" style="display:none; z-index: 1100; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center;">
        <div class="popup-content" style="max-width: 350px;">
            <button class="close-popup" onclick="fermerPlanif()">Ã—</button>
            <h3 id="planif-titre">ğŸ“… Planifier</h3>
            <p style="font-size: 0.9rem; color: #666;">Choisissez la date et l'heure de passage souhaitÃ©es.</p>
            <input type="datetime-local" id="date-planif" style="width: 100%; padding: 10px; margin: 15px 0; border: 1px solid #ddd; border-radius: 8px;">
            <button class="btn-inscription" onclick="sauvegarderPlanif()" style="width: 100%;">ENREGISTRER CE CRÃ‰NEAU</button>
        </div>
    </div>
    <div id="modal-livraisons" class="modal-system">
    <div class="modal-box" style="max-height: 80vh; display: flex; flex-direction: column;">
        <button class="close-popup" onclick="fermerLivraisons()">Ã—</button>
        <h3>ğŸšš Mes Livraisons</h3>
        <div id="liste-livraisons" style="text-align: left; margin-top: 15px; flex-grow: 1; overflow-y: auto;"></div>
        <button onclick="viderHistorique()" style="margin-top: 15px; background: none; border: 1px solid #ccc; color: #888; padding: 8px; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
            <i class="fas fa-trash"></i> Effacer l'historique
        </button>
    </div>
</div>

    <script src="js/main.js"></script>

<div id="mvola-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:9999; color:white; text-align:center; padding-top:100px;">
    <div style="background:#fff; color:#333; width:90%; max-width:400px; margin:auto; padding:20px; border-radius:15px;">
        <img src="https://www.mvola.mg/wp-content/uploads/2022/03/logo-mvola.png" width="100">
        <h3 id="status-title">Paiement en cours...</h3>
        <p id="status-text">VÃ©rifiez votre tÃ©lÃ©phone, une demande de paiement a Ã©tÃ© envoyÃ©e.</p>
        <div class="loader">ğŸ”„</div> <p style="font-size:12px; color:gray;">Ne fermez pas cette fenÃªtre avant la fin de la transaction.</p>
    </div>
</div>

<script>
    function showFakeNotif() {
        const locations = ["Itaosy", "Ivato", "Analakely", "67Ha", "Tanjombato"];
        const loc = locations[Math.floor(Math.random() * locations.length)];
        const toast = document.createElement('div');
        toast.style = "position:fixed; bottom:20px; left:20px; background:white; border-left:4px solid #ffcc00; padding:12px; border-radius:8px; box-shadow:0 10px 25px rgba(0,0,0,0.2); z-index:10000; font-size:0.75rem; animation: slideIn 0.5s ease-out;";
        toast.innerHTML = `ğŸ›’ Une commande vient d'Ãªtre passÃ©e Ã  <b>${loc}</b>`;
        document.body.appendChild(toast);
        setTimeout(() => { toast.style.opacity="0"; setTimeout(()=>toast.remove(), 1000); }, 4000);
    }
    // DÃ©clencher aprÃ¨s 10 secondes
    setTimeout(showFakeNotif, 10000);
</script>

<div class="floating-cart" onclick="envoyerCommande()" style="position: fixed; bottom: 20px; right: 20px; background: #ffcc00; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 25px rgba(0,0,0,0.3); z-index: 999; cursor: pointer; border: 3px solid #1a1a1a; animation: bounce 2s infinite;">
    <i class="fas fa-shopping-basket" style="font-size: 1.5rem; color: #1a1a1a;"></i>
    <span id="cart-count-float" style="position: absolute; top: 0; right: 0; background: #ff3b30; color: white; border-radius: 50%; padding: 4px 8px; font-size: 0.7rem; font-weight: bold;">0</span>
</div>
<div class="mobile-bottom-nav">
    <div class="nav-item-m active-m" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
        <i class="fas fa-home"></i>
        <span>Accueil</span>
    </div>
    <div class="nav-item-m" onclick="document.getElementById('search').focus()">
        <i class="fas fa-search"></i>
        <span>Chercher</span>
    </div>
    <div class="nav-item-m" onclick="envoyerCommande()">
        <div style="position:relative;">
            <i class="fas fa-shopping-bag"></i>
            <span id="cart-dot" style="display:none; position:absolute; top:-2px; right:-2px; width:8px; height:8px; background:#ff3b30; border-radius:50%; border:2px solid white;"></span>
        </div>
        <span>Panier</span>
    </div>
    <div class="nav-item-m" onclick="toggleSidebar()">
        <i class="fas fa-user-circle"></i>
        <span>Profil</span>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<div class="theme-controls">
    <button onclick="changerTheme('blanc')" class="btn-theme">âšª Clair</button>
    <button onclick="changerTheme('moderne')" class="btn-theme">ğŸ”˜ Moderne</button>
    <button onclick="changerTheme('sombre')" class="btn-theme">âš« Sombre</button>
</div>

<div id="qr-modal" class="modal-overlay" onclick="fermerQR()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <h3>Mon QR Code Client</h3>
        <div id="qrcode"></div> <p id="qr-tel-display"></p>
        <button onclick="fermerQR()" class="btn-fermer">Fermer</button>
    </div>
</div>

<button onclick="ouvrirQR()" class="btn-mon-qr">
    <i class="fas fa-qrcode"></i> Mon Pass
</button>
</body>
</html>